
# 相談20250811 品質を安定させるための外部CI対応

やりたいこと：今のワークフロー
```
{トラッカーID}

* [Claude]GoogleStatusステータス更新
* [Claude]実装
* [Claude]修正内容の報告（いったんここで止めて）
* [ユーザー]ユーザーのLGTM
* [Claude]テスト、ユニットテスト、動作確認
* [Claude]ワークフロー実行、上記トラッカーIDでワークフロー実行
* [Claude]テストやデモじゃないので全画像を対象として,
	* [Claude]抽出バッチを実行(バックグラウンド)
		１ファイルに５分以上かかる場合は、一旦ストップしてユーザーに確認させること
* [ユーザー]ダッシュボード確認
```

これをGithubのActionにレビューと動作確認とCIを肩代わりしてほしい

新しいワークフロー
やりたいこと：今のワークフロー
MR：MergeRequest（PR:PullRequestともいう）
```
{トラッカーID}

* [local/Claude]GoogleStatusステータス更新
* [local/Claude]featureブランチを切って別のブランチで開発
* [local/Claude]実装
	* [local/Claude]実装
* [local/Claude]修正内容のMRのpushとMRの作成
* [github]CIが回る
	* [github]動作チェック
	* [github]UnitTest（今あるtestディレクトリ以下のテスト全部）
		* [github]テストの中には画像抽出もあるので唯一テスト用の漫画アニメキャラクターの画像をpushするのでそれが抽出できてるかを確認すること
	* [github]QCチェック（今あるQC関係全部）
	* [local/Claude]MRの状態を確認する（5分ごとに確認）CIがすべてSUCCEEDされてるかチェック、されてないなら修正して（成功するまで何度もくり返し改善）
	* 具体的には
	* https://github.com/miyashita337/segment-anything/pull/{pull_request_id}
  ですべてのCIやチェックやアクションが通ったら報告してください、それができてない場合は繰り返し改善をしてください

* [ユーザー]ユーザーのLGTMおよびマージする
* [local/Claude]MRの状態を確認する（１０分ごとに確認）マージされてたら、次の
* [local/Claude]ワークフロー実行、上記トラッカーIDでワークフロー実行
* [local/Claude]テストやデモじゃないので全画像を対象として,抽出プログラム実行(features/extraction/commands/extract_character.py)
	* [local/Claude]抽出バッチを実行(バックグラウンド)
		１ファイルに５分以上かかる場合は、一旦ストップしてユーザーに確認させること
* [local/Claude]ダッシュボード作成
	* [local/Claude]ダッシュボード確認
		* curl http://100.123.241.106:8088/tracker/{トラッカーID}が表示できてること
		* ダッシュボード内の画像もブラウザ上で表示できてることを確認できてること
		* 画像はBase64ではなく画像パスであること
* [ユーザー]ダッシュボード確認

※重要事項
>テストの中には画像抽出もあるので唯一テスト用の漫画アニメキャラクターの画像をpushするのでそれが抽出できてるかを確認すること
>これはユーザーが用意します
>
/mnt/c/AItools/segment-anything/assets/test_demo1.jpg
/mnt/c/AItools/segment-anything/assets/test_demo2.jpg
/mnt/c/AItools/segment-anything/assets/test_demo3.jpg
これだけはcommit, push はOKにさせておきます
ユーザーが後で手動でgit操作してpushまでしておくのでClaudeはCI上でテストする画像が
./assets/test_demo1.jpg
./assets/test_demo2.jpg
./assets/test_demo3.jpg
であるということを認識していればOK、くりかえしますが、Claudeは絶対に自分の判断で画像をsegment-anythingリポジトリ内にcommit push しないようにしてください

```


これを実現させたいのですが、どうするのが一番いいですか？

以前やってた
ClaudeCodeGithubActionをもう一度復活させたほうがいい？それとも別の方法が良い？

# 不明点

判断できないところあれば何でもいいのでヒアリングしてください

特に問題なさそうなら、トラッカー起票してください
* 優先度：優先度最高



--------------

 1. CI実行環境要件
    - GPU必要性: SAM+YOLO抽出処理にGPUが必須？
いりません、CI上はあくまでもコード品質やPythonの統計上の整合性があってるかどうかをレビューするものにしたい、逆に教えてほしいSAM+YOLO抽出処理にGPUを使わない場合どんな問題が生じるのか？
    - メモリ要件: 現在のローカル環境スペック目安
spec.mdを参照、Ciでそれと同じものが用意するのが難しい場合は、メモリを食うてすとがどれか教えて

    - 実行時間制限: GitHub Actions無料枠（月2000分）で十分？

あくまでも無料枠のみ、フラグ管理一つでいつでももとに戻せれるようにして


>  2. テスト画像仕様
    - assets/test_demo*.jpgのファイルサイズ・解像度
100~500kb 解像度512x512程度

>    - 期待する抽出成功基準（成功率・品質スコア等）

最初は失敗でもいいので通したい、二回目以降は別チケットを作って成功率、品質スコアを上げるようにしたい


>	- テスト実行時間目安（3画像でどの程度？）
1画像５分以内




>  3. QCチェック範囲
    - 「今あるQC関係全部」の具体的スコープ

もしかしてQC関係のプログラムってなかったっけ？
C:\AItools\segment-anything\tests\qc　にあるものだけでいったんOK、増やしていきましょう

>    - 現在のQCスクリプトの実行時間・依存関係

１ファイル5分以上かかったらエラー、依存関係は仮想環境と同じようにDockerなどをCIで動かせれるようにlocalと同じものにさせておく

>    - 失敗時の許容基準・リトライロジック

いったんlocalでも通してるはずなのでlocalと同じqcの許容範囲にしてほしい、もしそんなものは存在しないという話なら、許容基準なんてないので、すべてOKとしてスルーさせる



>  4. ブランチ戦略
    - feature branch → main のシンプル構成で良い？
OK


>    - develop branch や release branch の必要性

個人開発なのでいらない


>    - トラッカーごとに個別ブランチ（feature/QCC-XXX-XXX）？

はい、それでOK、マージされたらトピックブランチは削除

> 5. CI失敗時の対応
エラーになったらPushoverに通知
keyなどはgithubのCI環境変数に組み込んでおきます、変数名だけ決めておきましょう

PUSHOVER_API_TOKEN
PUSHOVER_USER_KEY





  >5. CI失敗時の対応
    - 「修正してのMRのpush」の自動化範囲
	    - pipelineのjobページをClaudeにわたす（Pushover, http://100.123.241.106:8088/ なんでもいいです）
	    - それをサーバーが受け取ったら、localのClaudeに修正依頼、自動実装 -> 動作テスト、軽いテスト,localでCIをまわした後、commit、再度pushのサイクル
	    - （意図は伝わりますか？すべて自動でサイクルを回せれるようにしたい）
	- どこまでClaudeが自動修正すべき？
		- 基本的に全て、同じ失敗を３回したら修正の手を止めてユーザーに相談
    - ユーザー介入が必要な失敗パターン
	    - 主にスペック的どうしようもない問題
	    - 自己矛盾が生じてるパターン
	    - デッドロック、ハングアップ問題
	    - デグレードなど全体俯瞰しておかしいとき
	    - 


>    - ユーザー介入が必要な失敗パターン
  6. 通知・監視
>    - CI状態確認頻度（5分間隔は適切？）

CIから失敗成功を能動的に渡せれるなら監視は必要ない、単に自動で全て動くシステムがほしいだけ

>    - 失敗時の通知方法（Pushover/Slack等）

なんでもいい、（Pushover, http://100.123.241.106:8088/ なんでもいいです）

>    - ダッシュボード生成完了の確認方法

*curl http://100.123.241.106:8088/tracker/{トラッカーID}が表示できてること

* ダッシュボード内の画像もブラウザ上で表示できてることを確認できてること

* 画像はBase64ではなく画像パスであること


追加

>    - assets/test_demo*.jpgのファイルサイズ・解像度

  - assets/test_demo*.pngになりました

もう今は存在してるので解像度も確認できます


>  1. 🚨 GPU vs CPU処理矛盾: spec.mdではGPU必須だが、CI環境でGPU不要要求
CPU処理だと難しいですかね？GPUを動かす箇所は迂回とかしたらどうなる？

  
 > 2. ⚡ SAM+YOLO CPU処理の問題点予想:
>    - 処理速度: GPU 5-10秒/画像 → CPU 5-15分/画像（推定50-100倍悪化）
    - メモリ使用量: RAM使用量2-5倍増加の可能性
    - 品質低下: CPU推論精度がやや劣る可能性
  
  仮に「SAM+YOLO CPU処理のが問題ある」なら「SAM+YOLOなしで CPU処理だけ」で処理したらどういうことになります？
  
  
>  3. 💰 GitHub Actions制限: 無料枠2000分/月（CI環境での長時間処理制約）

ここは無料のままで


-------------


>  GPU処理 (現在):
    - test_demo1: 5-10秒
    - test_demo2: 3-7秒
    - test_demo3: 2-5秒
    - 合計: 10-22秒
>  CPU処理 (推定):
    - test_demo1: 2-8分 (高解像度影響大)
    - test_demo2: 1-4分
    - test_demo3: 30秒-2分
    - 合計: 4-14分 (予想レンジ内)
    - 
  メモリ使用量予測
  GPU処理: VRAM 2-4GB + RAM 1-2GB
  CPU処理: RAM 4-8GB (2-3倍増加)
  GitHub Actions制限: 7GB RAM → 問題なし


これは
test_demo1〜３.png

の解像度を低くしたらもっとCPU処理を少なくできますか？

---------------------


● 🎯 解像度による CPU処理時間短縮効果分析

  📊 現在の解像度とピクセル数

  現在のtest_demo*.png:
    test_demo1: 2539×1870 = 4,747,930ピクセル (4.7MP)
    test_demo2: 1546×1050 = 1,623,300ピクセル (1.6MP)
    test_demo3: 1167×849  = 990,483ピクセル  (1.0MP)

  ⚡ 解像度削減による処理時間短縮効果

  SAM・YOLO処理時間 = ピクセル数にほぼ比例

  512×512 (0.26MP) にリサイズした場合:

  処理時間短縮率:
    test_demo1: 4.7MP → 0.26MP = 約1/18倍 → 2-8分 → 10-30秒
    test_demo2: 1.6MP → 0.26MP = 約1/6倍  → 1-4分 → 10-40秒
    test_demo3: 1.0MP → 0.26MP = 約1/4倍  → 30秒-2分 → 10-30秒

  予想合計時間: 30秒-1分40秒 (現在の4-14分から大幅短縮)

  1024×1024 (1.0MP) にリサイズした場合:

  処理時間短縮率:
    test_demo1: 4.7MP → 1.0MP = 約1/5倍  → 2-8分 → 30秒-90秒
    test_demo2: 1.6MP → 1.0MP = 約1/1.6倍 → 1-4分 → 40秒-150秒
    test_demo3: 1.0MP → 1.0MP = 約1倍    → 30秒-2分 → 30秒-2分

  予想合計時間: 2-6分 (現在の4-14分から半減)

  🔍 推奨戦略: 段階的解像度最適化

  Phase 1: 超軽量CI (GitHub Actions制限対応)

  CI環境設定:
    target_resolution: "512×512"
    処理時間目標: "3画像で2分以内"
    GitHub Actions消費: "コード品質5分 + 画像テスト2分 = 7分/トラッカー"
    月間処理可能: "280トラッカー以上"

  Phase 2: バランス型CI (品質向上後)

  CI環境設定:
    target_resolution: "1024×1024"
    処理時間目標: "3画像で6分以内"
    品質: "実用的な抽出品質確保"
    GitHub Actions消費: "11分/トラッカー"
    月間処理可能: "180トラッカー"

  Local環境 (変更なし)

  Local環境:
    resolution: "元解像度維持"
    品質: "最高品質"
    処理時間: "GPU使用で10-22秒"

  💡 実装方針: 環境別自動リサイズ

  # CI環境検出とリサイズ実装例
  def get_target_resolution():
      if os.getenv('CI_ENVIRONMENT') == 'true':
          return (512, 512)  # Phase 1: 超軽量
      elif os.getenv('CI_BALANCED_MODE') == 'true':
          return (1024, 1024)  # Phase 2: バランス
      else:
          return None  # Local: 元解像度維持

  def preprocess_for_ci(image_path):
      target_res = get_target_resolution()
      if target_res:
          # PIL等でリサイズ処理
          return resize_image(image_path, target_res)
      return image_path  # そのまま

  📊 品質 vs 処理時間のトレードオフ

  | 解像度       | 処理時間   | 抽出品質  | CI適用性 | 推奨用途       |
  |-----------|--------|-------|-------|------------|
  | 元解像度      | 4-14分  | ★★★★★ | ❌     | Local環境    |
  | 1024×1024 | 2-6分   | ★★★★☆ | 🔶    | CI Phase 2 |
  | 512×512   | 30秒-2分 | ★★★☆☆ | ✅     | CI Phase 1 |

  🎯 結論: 大幅短縮可能

  ✅ 512×512リサイズ → 90%以上の処理時間短縮✅ 1024×1024リサイズ → 50-60%の処理時間短縮✅ GitHub Actions無料枠 → 大幅な余裕確保✅ 段階的品質向上 →
  フェーズ別最適化可能

  推奨: Phase 1では512×512で超軽量CI構築、Phase 2で1024×1024に段階的向上

> test_demo1〜３.png　リサイズ、解像度低くしました

● 🔍 リサイズ後のtest_demo.png解像度・ファイルサイズ確認*

● Bash(ls -lh /mnt/c/AItools/segment-anything/assets/test_demo*.png)
  ⎿  -rwxrwxrwx 1 shakufuku shakufuku 323K Aug 11 17:52 /mnt/c/AItools/segment-anything/assets/test_demo1.png
     -rwxrwxrwx 1 shakufuku shakufuku 418K Aug 11 17:52 /mnt/c/AItools/segment-anything/assets/test_demo2.png
     -rwxrwxrwx 1 shakufuku shakufuku 371K Aug 11 17:53 /mnt/c/AItools/segment-anything/assets/test_demo3.png

● Bash(python3 -c "
      from PIL import Image…)
  ⎿  リサイズ後のtest_demo*.png解像度・サイズ確認:
     ------------------------------------------------------------
     test_demo1.png: 695×512 (0.4MP), 323KB
     … +3 lines (ctrl+r to expand)

● 🎉 素晴らしい！大幅な軽量化達成

  📊 リサイズ効果確認

  Before (リサイズ前) vs After (リサイズ後)

  | 画像         | リサイズ前                    | リサイズ後                  | 削減率   | 処理時間予想短縮        |
  |------------|--------------------------|------------------------|-------|-----------------|
  | test_demo1 | 2539×1870 (4.7MP), 1.6MB | 695×512 (0.4MP), 323KB | 92%削減 | 2-8分 → 15-40秒   |
  | test_demo2 | 1546×1050 (1.6MP), 1.0MB | 754×512 (0.4MP), 418KB | 75%削減 | 1-4分 → 15-40秒   |
  | test_demo3 | 1167×849 (1.0MP), 659KB  | 704×512 (0.4MP), 370KB | 64%削減 | 30秒-2分 → 10-30秒 |

  🚀 処理時間予想 (CPU環境)

  リサイズ前: 4-14分 (合計)

  リサイズ後: 40秒-110秒 (合計)

  - 🎯 約90%の処理時間短縮達成！
  - ✅ GitHub Actions 5分制限内に余裕で収まる
  - ✅ 1画像あたり30秒以内の可能性大

  💡 CI統合への影響

  GitHub Actions無料枠活用効率

  Before (高解像度):
    画像テスト: 4-14分
    総CI時間: 9-19分/トラッカー
    月間処理: 105-220トラッカー

  After (軽量化):
    画像テスト: 1-2分
    総CI時間: 6-7分/トラッカー
    月間処理: 285-330トラッカー (約3倍向上！)

  CI環境での実行可能性

  - ✅ 1画像5分制限: 余裕でクリア
  - ✅ 3画像処理: 2分以内で完了見込み
  - ✅ メモリ制限: 7GB RAMで問題なし
  - ✅ 安定性: タイムアウトリスク大幅削減

  🎯 最適化されたCI統合計画
  ⎿  User rejected Claude's plan:
     ╭──────────────────────────────────────────────────────────────────────────────────────╮
     │ CI統合システム実装計画 (最終版)                                                      │
     │                                                                                      │
     │ 🎉 前提条件: 大幅軽量化達成済み                                                      │
     │                                                                                      │
     │ リサイズ効果確認:                                                                    │
     │ - test_demo1-3: 4.7MP+1.6MP+1.0MP → 全て0.4MP                                        │
     │ - 処理時間予想: 4-14分 → 40秒-2分 (90%短縮)                                          │
     │ - GitHub Actions制限: 完全にクリア                                                   │
     │                                                                                      │
     │ 🚀 Phase 1: 超軽量CI基盤構築 (優先度: 最高)                                          │
     │                                                                                      │
     │ 1.1 GitHub Actions環境セットアップ                                                   │
     │                                                                                      │
     │ # .github/workflows/tracker-ci.yml                                                   │
     │ name: "Tracker Quality CI"                                                           │
     │ on:                                                                                  │
     │   pull_request:                                                                      │
     │     branches: [main]                                                                 │
     │     paths-ignore: ['docs/**', '*.md']                                                │
     │                                                                                      │
     │ jobs:                                                                                │
     │   quality-check:                                                                     │
     │     runs-on: ubuntu-latest                                                           │
     │     timeout-minutes: 15  # 十分な余裕                                                │
     │                                                                                      │
     │     strategy:                                                                        │
     │       matrix:                                                                        │
     │         python-version: [3.8, 3.10]                                                  │
     │                                                                                      │
     │     env:                                                                             │
     │       CI_ENVIRONMENT: "true"                                                         │
     │       PUSHOVER_API_TOKEN: ${{ secrets.PUSHOVER_API_TOKEN }}                          │
     │       PUSHOVER_USER_KEY: ${{ secrets.PUSHOVER_USER_KEY }}                            │
     │                                                                                      │
     │ 1.2 Docker環境統一                                                                   │
     │                                                                                      │
     │ # .devcontainer/ci.Dockerfile                                                        │
     │ FROM python:3.10-slim                                                                │
     │ RUN apt-get update && apt-get install -y \                                           │
     │     build-essential python3-dev libgl1-mesa-glx libglib2.0-0                         │
     │ COPY requirements.txt .                                                              │
     │ RUN pip install -r requirements.txt                                                  │
     │                                                                                      │
     │ 1.3 CI専用設定                                                                       │
     │                                                                                      │
     │ # CI環境では自動的に軽量モード適用                                                   │
     │ if os.getenv('CI_ENVIRONMENT') == 'true':                                            │
     │     SAM_MODEL = "sam_vit_b_01ec64.pth"  # 軽量SAM-B                                  │
     │     YOLO_MODEL = "yolov8n.pt"           # nano版YOLO                                 │
     │     MAX_PROCESSING_TIME = 300           # 5分制限                                    │
     │     CPU_ONLY = True                     # GPU無効                                    │
     │                                                                                      │
     │ 🧪 Phase 2: テスト統合パイプライン                                                   │
     │                                                                                      │
     │ 2.1 基本品質チェック                                                                 │
     │                                                                                      │
     │ steps:                                                                               │
     │   - name: Code Quality                                                               │
     │     run: |                                                                           │
     │       ./bin/shell/linter.sh                                                          │
     │       pytest tests/unit/ -v                                                          │
     │       python -m pytest tests/integration/test_qcc_fix_001_integration.py             │
     │                                                                                      │
     │ 2.2 画像抽出テスト (超軽量)                                                          │
     │                                                                                      │
     │   - name: Image Extraction Test                                                      │
     │     run: |                                                                           │
     │       # 軽量化された3画像で抽出テスト (予想2分以内)                                  │
     │       python3 features/extraction/commands/extract_character.py \                    │
     │         ./assets/test_demo1.png -o /tmp/ci_test1/ --ci-mode                          │
     │       python3 features/extraction/commands/extract_character.py \                    │
     │         ./assets/test_demo2.png -o /tmp/ci_test2/ --ci-mode                          │
     │       python3 features/extraction/commands/extract_character.py \                    │
     │         ./assets/test_demo3.png -o /tmp/ci_test3/ --ci-mode                          │
     │     timeout-minutes: 5  # 十分な余裕                                                 │
     │                                                                                      │
     │ 2.3 QC統合テスト                                                                     │
     │                                                                                      │
     │   - name: QC Integration Test                                                        │
     │     run: |                                                                           │
     │       python tests/qc/unified_batch_extraction.py --ci-mode                          │
     │       python tests/qc/compatible_extraction_system.py /tmp/ci_test1/ /tmp/qc_output/ │
     │                                                                                      │
     │ 🔄 Phase 3: 自動修正・通知システム                                                   │
     │                                                                                      │
     │ 3.1 失敗時通知                                                                       │
     │                                                                                      │
     │   - name: Failure Notification                                                       │
     │     if: failure()                                                                    │
     │     run: |                                                                           │
     │       curl -s \                                                                      │
     │         --form-string "token=$PUSHOVER_API_TOKEN" \                                  │
     │         --form-string "user=$PUSHOVER_USER_KEY" \                                    │
     │         --form-string "message=CI Failed: ${{ github.event.pull_request.title }}" \  │
     │         --form-string "url=${{ github.event.pull_request.html_url }}" \              │
     │         https://api.pushover.net/1/messages.json                                     │
     │                                                                                      │
     │ 3.2 自動修正サイクル設計                                                             │
     │                                                                                      │
     │ CI失敗 → Pushover通知 → WebHook受信 → ローカルClaude起動                             │
     │ → エラー分析 → コード修正 → ローカルテスト → commit・push                            │
     │ → CI再実行 (最大3回まで自動リトライ)                                                 │
     │                                                                                      │
     │ 3.3 WebHook受信システム                                                              │
     │                                                                                      │
     │ # ローカルサーバー for CI失敗通知受信                                                │
     │ @app.route('/ci-failure-webhook', methods=['POST'])                                  │
     │ def handle_ci_failure():                                                             │
     │     # GitHub WebHook受信                                                             │
     │     # ローカルClaude起動                                                             │
     │     # 自動修正実行                                                                   │
     │                                                                                      │
     │ 📊 Phase 4: ダッシュボード統合                                                       │
     │                                                                                      │
     │ 4.1 成功時ダッシュボード自動生成                                                     │
     │                                                                                      │
     │   - name: Dashboard Generation (on merge)                                            │
     │     if: github.event.pull_request.merged == true                                     │
     │     run: |                                                                           │
     │       # mainブランチマージ時のみ実行                                                 │
     │       ./tools/scripts/run_quality_workflow.sh ${{ env.TRACKER_ID }}                  │
     │       curl -f http://100.123.241.106:8088/tracker/${{ env.TRACKER_ID }}              │
     │                                                                                      │
     │ 4.2 品質確認                                                                         │
     │                                                                                      │
     │ # CI成功後の確認項目                                                                 │
     │ 1. ダッシュボードアクセス確認                                                        │
     │ 2. 画像パス参照確認（Base64禁止）                                                    │
     │ 3. 抽出画像表示確認                                                                  │
     │                                                                                      │
     │ 🎯 期待されるCI処理時間                                                              │
     │                                                                                      │
     │ 軽量化後の予想時間配分:                                                              │
     │                                                                                      │
     │ Code Quality: 2-3分                                                                  │
     │ Unit Tests: 1-2分                                                                    │
     │ Image Extraction: 1-2分 (大幅短縮!)                                                  │
     │ QC Tests: 1分                                                                        │
     │ Total: 5-8分/トラッカー                                                              │
     │                                                                                      │
     │ GitHub Actions消費量:                                                                │
     │ - 月間2000分制限                                                                     │
     │ - 処理可能トラッカー: 250-400個                                                      │
     │ - 1日平均: 8-13トラッカー処理可能                                                    │
     │                                                                                      │
     │ ⚠️ 重要事項・制約                                                                    │
     │                                                                                      │
     │ CI環境でのテスト成功基準                                                             │
     │                                                                                      │
     │ - Phase 1: エラーなく完了すればOK（品質は問わない）                                  │
     │ - 統計整合性: QCC-FIX-001準拠チェック                                                │
     │ - コード品質: flake8, pytest必須通過                                                 │
     │                                                                                      │
     │ フラグ管理 (いつでも元に戻せる)                                                      │
     │                                                                                      │
     │ CI_INTEGRATION_ENABLED = os.getenv('CI_INTEGRATION_ENABLED', 'false')                │
     │ if CI_INTEGRATION_ENABLED != 'true':                                                 │
     │     # 従来のローカルワークフロー実行                                                 │
     │     return run_local_workflow()                                                      │
     │                                                                                      │
     │ 🎊 実装優先順位                                                                      │
     │                                                                                      │
     │ 1. 最優先: GitHub Actions基本CI (コード品質・統計チェック)                           │
     │ 2. 高優先: 画像抽出テスト (軽量3画像)                                                │
     │ 3. 中優先: QC統合テスト                                                              │
     │ 4. 低優先: 自動修正・WebHook連携                                                     │
     │ 5. 段階的: ダッシュボード統合・通知システム                                          │
     │                                                                                      │
     │ 実装開始条件: ユーザーの承認後、トラッカー起票（優先度最高）                         │
     ╰──────────────────────────────────────────────────────────────────────────────────────╯



OKです、この計画書をGoogleSheetに起票してください
トラッカーID：CI-INTEGRATION-001 (こういうトラッカーIDも昔はエラーになってたけど今はエラーにならないはずです)
優先度は：優先度最高
概要：おまかせします
詳細：計画書の内容そのまま流用して
登録日付：現在時刻

すいませんそういえば、レビューはgithub上の@claudeに依頼したいのですが、それは可能ですよね？



│ > https://github.com/miyashita337/segment-anything/actions/runs/16876296171/job/47801554845 こちらの code-qualityもエラーです                                       │

今回かなりワークフローが変わりました
CLAUDE.md及び全てのmdファイルを総じてみて、修正が必要であれば修正してほしい



では
* ワークフロー実行、CI-INTEGRATION-001
* テストやデモじゃないので全画像を対象として,
* 抽出バッチを実行(バックグラウンド)

```
入力パス(input)：   /mnt/c/AItools/lora/train/yado/org/kaname08 
出力パス(output)：   
 /mnt/c/AItools/lora/train/yado/tracker-workspace/CI-INTEGRATION-001/
```
	１ファイルに５分以上かかる場合は、一旦ストップしてユーザー二確認させること
* ダッシュボード作成および確認
	* *curl http://100.123.241.106:8088/tracker/{トラッカーID}が表示できてること
	* ダッシュボード内の画像もブラウザ上で表示できてることを確認できてること
	* 画像はBase64ではなく画像パスであること
* 




> 基本的にhttps://github.com/miyashita337/segment-anything/pull/{pull request id（今回は23）}
  ですべてのCIやチェックやアクションが通ったら報告してください、それができてない場合は繰り返し改善をしてください
