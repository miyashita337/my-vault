ワークフローの手順を教えて下さい

* 始める前に、なにが必要ですか？必須で提出するパラメータはありますか？
* ワークフローの流れを教えて下さい

  * 始める前に、なにが必要ですか？必須で提出するパラメータはありますか？
  * ワークフローの流れを教えて下さい

● � トラッカーワークフロー完全ガイド

  � 開始前の必須準備事項

● ✅ 必須パラメータ

  1. トラッカーID（必須）
  フォーマット: {PREFIX}-{NUMBER}
  例: INCI-005, QUAL-040, OPTM-007, TEST-001

  【使用される場面】
  - Google Sheetsのトラッカー登録
  - Git feature ブランチ名
  - ワークスペースディレクトリ名
  - Pull Request タイトル
  - ファイル名・ログ名

  2. 入力ディレクトリ（抽出処理がある場合）
  標準パス: /mnt/c/AItools/lora/train/yado/org/{データセット名}/
  例: /mnt/c/AItools/lora/train/yado/org/kana05/
     /mnt/c/AItools/lora/train/yado/org/kana08/

  【重要】存在しない入力ディレクトリでの処理は厳禁

  3. 出力ディレクトリ（自動生成）
  標準パス: /mnt/c/AItools/lora/train/yado/tracker-workspace/{TRACKER_ID}/
  構造: {TRACKER_ID}/
        ├── extraction/     # 抽出結果画像
        ├── dashboard/      # ダッシュボードHTML
        ├── quality/        # 品質評価JSON
        └── tests/          # テスト結果

  � 環境準備

  1. sam-env仮想環境（必須）
  # 仮想環境確認
  echo $VIRTUAL_ENV

  # 未アクティベート時
  source sam-env/bin/activate

  # 確認
  which python3  # /mnt/c/AItools/segment-anything/sam-env/bin/python3

  2. Google Sheets認証
  # 権限確認
  python tools/progress_tracker/cli.py permission-status

  # 必要に応じて権限設定
  python tools/progress_tracker/cli.py set-permission EXECUTE_FULL

  3. 必須ファイル存在確認
  # SAMモデル確認
  ls sam_vit_h_4b8939.pth

  # YOLOモデル確認
  ls yolov8n.pt yolov8x.pt

  # 設定ファイル確認
  ls config/pushover.json

  � 13ステップ・4フェーズワークフロー

● � Phase 1: 計画・準備（ステップ0-4）

  ステップ0: sam-env確認・アクティベート
  echo $VIRTUAL_ENV
  source sam-env/bin/activate
  which python3

  ステップ1: トラッカーID決定・要件確認
  # Google Sheetsで新規トラッカー作成
  python tools/progress_tracker/cli.py create {TRACKER_ID} --description "タスク概要"

  # ステータス更新
  python tools/progress_tracker/cli.py update {TRACKER_ID} "着手中"

  # Git作業ブランチ作成
  git checkout -b feature/{TRACKER_ID}

  ステップ2: 仕様書・事例調査
  - CLAUDE.md - トラッカーワークフロー要件
  - docs/templates/unified_tracker_template.md - 統合テンプレート
  - docs/checklists/tracker_workflow_checklist.md - 詳細チェックリスト

  ステップ3: 計画書作成
  - 実装計画・品質基準・測定計画
  - リスク分析・例外処理手順

  ステップ4: � 承認1（計画承認）
  - 計画レビュー・ベースライン測定
  - ユーザー承認待ち

  � Phase 2: 実装・テスト（ステップ5-8）

  ステップ5: � 承認2（ワークスペース承認）
  # ワークスペース作成
  mkdir -p /mnt/c/AItools/lora/train/yado/tracker-workspace/{TRACKER_ID}/{extraction,quality,dashboard,tests}

  ステップ6: 抽出実行・Git管理
  # 抽出実行（推奨コマンド）
  python features/extraction/commands/extract_character.py \
    /input/path/ -o /output/path/ --batch --verbose

  # または大量処理時
  nohup MEMORY_LIMIT_DISABLED=true python3 features/extraction/commands/extract_character.py \
    /input/path/ -o /output/path/ --batch --verbose > extraction.log 2>&1 &

  ステップ7: テスト実行
  python -m pytest tests/unit/ -v
  python -m pytest tests/integration/ -v

  ステップ8: � 承認3（テスト結果承認）
  # Git操作（個別ファイル指定）
  git status
  git add [具体的ファイル名]  # git add . 禁止
  git commit -m "feat({TRACKER_ID}): ..."
  git push -u origin feature/{TRACKER_ID}

  � Phase 3: 品質ワークフロー（ステップ9-11）【必須順序遵守】

  ステップ9A: 品質ワークフロー実行
  # 【必須順序1】
  ./tools/scripts/run_quality_workflow.sh {TRACKER_ID}

  ステップ9B: ダッシュボード生成
  # 【必須順序2】ダッシュボード生成確認
  ls workspace/{TRACKER_ID}/dashboard/dashboard.html

  ステップ9C: 統計分析実行
  # 【必須順序3】統計分析
  python3 tools/progress_tracker/universal_statistical_analyzer.py \
    --current {TRACKER_ID} --baseline {BASELINE_ID}

  ステップ10: 修正・最適化ループ
  - 品質問題発見時：修正→ステップ9A-9C繰り返し

  ステップ11: � 承認4（品質ワークフロー結果承認）
  - 品質基準充足確認・ベースライン比較

  � Phase 4: 完了・承認（ステップ12-13）

  ステップ12: 変更コミット・ブランチプッシュ
  git add [具体的ファイル名]
  git commit -m "feat({TRACKER_ID}): [概要]

  - 主要変更点1
  - 主要変更点2

  � Generated with [Claude Code](https://claude.ai/code)

  Co-Authored-By: Claude <noreply@anthropic.com>"
  git push -u origin feature/{TRACKER_ID}

  ステップ13: � 承認5（最終承認・PR作成）
  gh pr create --title "feat({TRACKER_ID}): [概要]" --body "$(cat <<'EOF'
  ## Summary
  - [変更概要]

  ## Changes
  - [具体的変更内容]

  ## Test plan
  - [x] [検証項目1]
  - [x] [検証項目2]

  � Generated with [Claude Code](https://claude.ai/code)
  EOF
  )"

  ステップ13.5: PR完了処理
  # マージ後
  git checkout main && git pull
  python tools/progress_tracker/cli.py update {TRACKER_ID} "/release"

  ⚠️ 重要な注意事項

● � 絶対禁止事項

  1. Git操作
  - git add . - 大量未追跡ファイル（33,036個）の意図しないステージング
  - git add -A - 同上
  - git add --all - 同上

  2. 入力検証
  - 存在しない入力ディレクトリでの処理継続
  - エラーを無視した強制実行
  - デモファイル・プレースホルダー出力

  3. ステップ省略
  - 計画フェーズの省略
  - 品質ワークフロー省略
  - パフォーマンス測定省略

  ✅ 成功の鍵

  1. 順序厳守
  Phase 1完了 → Phase 2完了 → Phase 3完了 → Phase 4完了
  5回の承認ポイントでの必須確認

  2. 技術的困難時
  作業停止 → 状況整理 → 選択肢提示 → ユーザー相談 → 指示待ち

  3. 品質基準
  - 抽出成功率: 80%以上
  - 統合品質スコア: 0.7以上
  - テスト成功率: 95%以上
  - 統計的有意性確認

  � 実行例

● 実際の実行コマンド例（INCI-005の場合）:

  # Phase 1: 計画・準備
  source sam-env/bin/activate
  python tools/progress_tracker/cli.py create INCI-005 --description "キャラクター抽出精度向上"
  git checkout -b feature/INCI-005

  # Phase 2: 実装・テスト
  mkdir -p /mnt/c/AItools/lora/train/yado/tracker-workspace/INCI-005/{extraction,quality,dashboard,tests}

  python features/extraction/commands/extract_character.py \
    /mnt/c/AItools/lora/train/yado/org/kana05/ \
    -o /mnt/c/AItools/lora/train/yado/tracker-workspace/INCI-005/extraction/ \
    --batch --verbose

  git add features/extraction/commands/extract_character.py
  git commit -m "feat(INCI-005): キャラクター抽出精度向上実装"
  git push -u origin feature/INCI-005

  # Phase 3: 品質ワークフロー
  ./tools/scripts/run_quality_workflow.sh INCI-005

  python3 tools/progress_tracker/universal_statistical_analyzer.py \
    --current INCI-005 --baseline INCI-004

  # Phase 4: 完了・承認
  gh pr create --title "feat(INCI-005): キャラクター抽出精度向上" --body "..."

  # マージ後
  git checkout main && git pull
  python tools/progress_tracker/cli.py update INCI-005 "/release"

  � 期待される成果物

  各フェーズ完了時の成果物:

  Phase 1完了時:
  - Google Sheetsにトラッカー登録
  - 計画書（実装方針・品質基準）
  - Git feature ブランチ作成

  Phase 2完了時:
  - ワークスペースディレクトリ構造
  - 抽出処理実行結果
  - テスト実行結果
  - 初回Git commit & push

  Phase 3完了時:
  - workspace/{TRACKER_ID}/extraction/ - 抽出画像
  - workspace/{TRACKER_ID}/dashboard/dashboard.html - ダッシュボード
  - workspace/{TRACKER_ID}/quality/unified_quality_report.json - 品質レポート
  - statistical_analysis_final.json - 統計分析結果

  Phase 4完了時:
  - GitHub Pull Request
  - Google Sheets /release ステータス
  - Pushover完了通知


