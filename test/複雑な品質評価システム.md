
æ•™ãˆã¦ã»ã—ã„ã®ã§ã™ãŒ
>  # å•é¡Œè¦å› 2: è¤‡é›‘ãªå“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
>  quality_result = evaluate_extraction_quality(...)
  if quality_result.grade in ['C', 'D', 'E', 'F']:
      # è¤‡é›‘ãªæ”¹å–„å‡¦ç†

ã“ã‚Œã£ã¦å…·ä½“çš„ã«ã©ã†ã„ã†ã“ã¨ã‚’ã—ã¦ãŸã®ï¼Ÿã‚ã‹ã‚Šã‚„ã™ãæ•™ãˆã¦

â— ğŸ“Š P1-B004è¤‡é›‘å“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°è§£æ

  ã‚³ãƒ¼ãƒ‰åˆ†æã®çµæœã€P1-B004ã§å°å…¥ã•ã‚ŒãŸè¤‡é›‘ãªå“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã—ãŸï¼š

  ğŸ”¥ è¤‡é›‘ãª3å±¤å“è³ªæ”¹å–„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

  1ï¸âƒ£ IntegratedPrecisionPipelineï¼ˆçµ±åˆç²¾åº¦å‘ä¸Šãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼‰
  # 344-380è¡Œç›®
  precision_pipeline = IntegratedPrecisionPipeline()
  pipeline_result = precision_pipeline.process_with_integrated_pipeline(
      image=enhanced_bgr,
      initial_mask=mask,
      yolo_model=yolo_model,
      sam_model=sam_model,
      target_quality=0.5  # 50%å“è³ªç›®æ¨™
  )

  # è¤‡é›‘ãªè©•ä¾¡ãƒ­ã‚¸ãƒƒã‚¯
  if pipeline_result.success and pipeline_result.final_mask is not None:
      mask = pipeline_result.final_mask
      improvement_pct = pipeline_result.improvement_ratio * 100
      # æ”¹å–„ç‡ã€ãƒªãƒˆãƒ©ã‚¤å›æ•°ã€å‡¦ç†æ™‚é–“ãªã©ã‚’è©³ç´°ç›£è¦–

  2ï¸âƒ£ AutoMaskCorrectorï¼ˆè‡ªå‹•ãƒã‚¹ã‚¯ä¿®æ­£ã‚·ã‚¹ãƒ†ãƒ ï¼‰
  # 407-429è¡Œç›®
  auto_corrector = create_auto_mask_corrector(quality_focused=True)
  correction_result = auto_corrector.correct_mask_automatically(
      mask, enhanced_bgr, quality_score=quality_score
  )

  # æ”¹å–„ç‡åˆ¤å®šã«ã‚ˆã‚‹é©ç”¨åˆ¶å¾¡
  if improvement_ratio > 0.1:  # 10%ä»¥ä¸Šã®æ”¹å–„ãŒå¿…è¦
      mask = corrected_mask
      # ä¿®æ­£ãƒ­ã‚°ã‚’è©³ç´°å‡ºåŠ›

  3ï¸âƒ£ SAMPostprocessingPipelineï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ï¼‰
  # 382-404è¡Œç›®ï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
  postprocessor = SAMPostprocessingPipeline()
  enhancement_result = postprocessor.enhance_mask_quality(mask, enhanced_bgr)
  enhanced_mask = enhancement_result.get('enhanced_mask', mask)
  quality_score = enhancement_result.get('quality_score', 0.0)

  ğŸ¯ å…·ä½“çš„ã«ä½•ã‚’ã—ã¦ã„ãŸã‹

  A. çµ±åˆç²¾åº¦å‘ä¸Šãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆIntegratedPrecisionPipelineï¼‰
  - å“è³ªè©•ä¾¡: ãƒã‚¹ã‚¯ã‚’0.0ã€œ1.0ã§ã‚¹ã‚³ã‚¢åŒ–
  - ç›®æ¨™è¨­å®š: 50%å“è³ªã‚’ç›®æ¨™ã«è¨­å®š
  - 3æ®µéšå‡¦ç†:
    a. é©å¿œçš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
    b. YOLOæ¤œå‡ºç¯„å›²æ‹¡å¼µ
    c. SAMç²¾å¯†ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å†å®Ÿè¡Œ
  - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹: æœ€å¤§3å›ã¾ã§è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
  - å­¦ç¿’æ©Ÿèƒ½: å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜éŒ²ãƒ»å­¦ç¿’

  B. è‡ªå‹•ãƒã‚¹ã‚¯ä¿®æ­£ï¼ˆAutoMaskCorrectorï¼‰
  - ã‚¨ãƒƒã‚¸ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°: ã‚¬ã‚¦ã‚·ã‚¢ãƒ³ãƒ•ã‚£ãƒ«ã‚¿ã€ãƒã‚¤ãƒ©ãƒ†ãƒ©ãƒ«ãƒ•ã‚£ãƒ«ã‚¿
  - ãƒã‚¤ã‚ºé™¤å»: å°ã•ãªè¼ªéƒ­ã®é™¤å»ã€ãƒ¢ãƒ«ãƒ•ã‚©ãƒ­ã‚¸ãƒ¼æ¼”ç®—
  - ãƒ›ãƒ¼ãƒ«åŸ‹ã‚: ãƒã‚¹ã‚¯å†…ã®ç©´ã‚’è‡ªå‹•æ¤œå‡ºãƒ»åŸ‹ã‚
  - é©å¿œçš„èª¿æ•´: å“è³ªã‚¹ã‚³ã‚¢ã«å¿œã˜ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‹•çš„å¤‰æ›´

  C. å“è³ªåˆ¤å®šã‚·ã‚¹ãƒ†ãƒ 
  # æ”¹å–„ç‡ã«ã‚ˆã‚‹åˆ¤å®š
  improvement_ratio = (final_quality - initial_quality) / initial_quality
  if improvement_ratio > 0.1:  # 10%ä»¥ä¸Šæ”¹å–„ã§é©ç”¨
      # ä¿®æ­£ãƒã‚¹ã‚¯ã‚’æ¡ç”¨
  else:
      # å…ƒãƒã‚¹ã‚¯ã‚’ç¶™ç¶šä½¿ç”¨

  ğŸš¨ ä½•ãŒå•é¡Œã ã£ãŸã‹

  1. éåº¦ãªè¤‡é›‘åŒ–
  - QCæˆåŠŸç‰ˆ: ã‚·ãƒ³ãƒ—ãƒ«ãª np.argmax(scores) ã§æœ€è‰¯ãƒã‚¹ã‚¯é¸æŠ
  - P1-B004ç‰ˆ: 3å±¤ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ + ãƒªãƒˆãƒ©ã‚¤ + å­¦ç¿’æ©Ÿæ§‹

  2. å‡¦ç†æ™‚é–“ã®çˆ†ç™ºçš„å¢—åŠ 
  - QCæˆåŠŸç‰ˆ: 0.5ç§’/ç”»åƒ
  - P1-B004ç‰ˆ: æ•°åç§’/ç”»åƒï¼ˆãƒªãƒˆãƒ©ã‚¤è¾¼ã¿ï¼‰

  3. ä¸å®‰å®šæ€§ã®å¢—å¤§
  - å¤šå±¤å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿãƒã‚¤ãƒ³ãƒˆãŒå¢—åŠ 
  - å„å±¤ã§ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ãŒç›¸äº’å¹²æ¸‰
  - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹ãŒç„¡é™ãƒ«ãƒ¼ãƒ—ã®ãƒªã‚¹ã‚¯

  4. å“è³ªåŠ£åŒ–ã®ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹
  - å“è³ªå‘ä¸Šã‚’ç›®æŒ‡ã—ãŸçµæœã€å®‰å®šæ€§ãŒæãªã‚ã‚ŒãŸ
  - ã‚·ãƒ³ãƒ—ãƒ«ãªæˆåŠŸæ‰‹æ³•ã‚’è¤‡é›‘åŒ–ã§ç ´ç¶»ã•ã›ãŸ

  ğŸ’¡ æ•™è¨“

  ã€Œå®Œç’§ã‚’æ±‚ã‚ã™ãã¦å®Ÿç”¨æ€§ã‚’å¤±ã£ãŸå…¸å‹ä¾‹ã€
  - QCæˆåŠŸç‰ˆã®100%æˆåŠŸç‡ â†’ P1-B004ã§å¤§å¹…åŠ£åŒ–
  - ã‚·ãƒ³ãƒ—ãƒ«ã§ç¢ºå®Ÿ â†’ è¤‡é›‘ã§ä¸å®‰å®š
  - å®Ÿè¨¼æ¸ˆã¿æŠ€è¡“ â†’ å®Ÿé¨“çš„æŠ€è¡“ã®é‡è¤‡é©ç”¨

  ã“ã‚ŒãŒã¾ã•ã« YAGNIåŸå‰‡ï¼ˆYou Aren't Gonna Need Itï¼‰ã®é‡è¦æ€§ã‚’ç¤ºã™äº‹ä¾‹ã§ã—ãŸã€‚

------------------------------------




â”‚ â”‚ 1. å“è³ªã‚¹ã‚³ã‚¢è¨ˆç®—å¼ã®è©³ç´°åˆ†æ   
â”‚ â”‚ 2. 3ã¤ã®å“è³ªæŒ‡æ¨™ï¼ˆcompactness, fill_ratio, coverage_ratioï¼‰ã®å…·ä½“çš„æ„å‘³ 
â”‚ â”‚ 3. ã€Œç†è«–ä¸Šã®è‰¯ã„ã“ã¨ã€vsã€Œå®Ÿéš›ã«èµ·ã“ã£ãŸå•é¡Œã€ã®å¯¾æ¯” 
â”‚ â”‚ 4. QCæˆåŠŸç‰ˆï¼ˆ1è¡Œåˆ¤å®šï¼‰ã¨ã®é•ã„     
â”‚ â”‚ 5. éåº¦ãªæœ€é©åŒ–ã«ã‚ˆã‚‹å®Ÿç”¨æ€§ç ´ç¶»ã®æ•™è¨“  
â”‚ â”‚ æ ¸å¿ƒçš„ç™ºè¦‹:
â”‚ â”‚ - è‰¯ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æŠ½å‡ºï¼ˆQC 100%æˆåŠŸï¼‰ãŒå“è³ªã‚¹ã‚³ã‚¢0.27ã§ã€Œä½å“è³ªã€åˆ¤å®š 
â”‚ â”‚ - æ•°å€¤åŒ–ã«ã‚ˆã‚‹å®¢è¦³æ€§ã‚’ç›®æŒ‡ã—ãŸãŒã€ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸é©åˆã§é€†åŠ¹æœ 
â”‚ â”‚ - ã‚·ãƒ³ãƒ—ãƒ«ãª np.argmax(scores) ãŒå®Ÿéš›ã«ã¯æœ€é©è§£ã ã£ãŸ      

ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸é©åˆã¨ã„ã†ã“ã¨ã§ã™ãŒã€ã“ã®ã€Œå“è³ªæŒ‡æ¨™ã€ã¯ã‹ãªã‚Šé‡è¦ã ã¨æ€ã£ã¦ã‚‹ã®ã§ã™ãŒã€ã‚„ã‚ãŸã»ã†ãŒã„ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿä»£æ›¿ãˆæ¡ˆãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ

---------------------------------------------------

>  - å“è³ªè©•ä¾¡: ãƒã‚¹ã‚¯ã‚’0.0ã€œ1.0ã§ã‚¹ã‚³ã‚¢åŒ–
  - ç›®æ¨™è¨­å®š: 50%å“è³ªã‚’ç›®æ¨™ã«è¨­å®š
>
  å“è³ªæŒ‡æ¨™ã¯é‡è¦ â†’ é©åˆ‡ã«æ´»ç”¨ã™ã¹ã
  1. å®Œå…¨å»ƒæ­¢ã¯NG: å“è³ªç›£è¦–ãƒ»æ”¹å–„æ–¹å‘ã®æ¸¬å®šã«ä¾¡å€¤
>  1. P1-B004ã®å¤±æ•—: å®Ÿè£…æ–¹æ³•ã¨é©ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒä¸é©åˆ‡
  2. æ¨å¥¨æ–¹é‡: QCæˆåŠŸç‰ˆã‚’åŸºç›¤ã«ã€å“è³ªæŒ‡æ¨™ã‚’ç›£è¦–ãƒ»åˆ†æç”¨é€”ã§æ´»ç”¨
>  1. æ®µéšçš„æ”¹å–„: ãƒªã‚¹ã‚¯ã‚’å–ã‚‰ãšã«å¾ã€…ã«æŒ‡æ¨™ã‚’æ´—ç·´
  å“è³ªæŒ‡æ¨™ã®ä¾¡å€¤ã‚’æ´»ã‹ã—ã¤ã¤ã€QCæˆåŠŸç‰ˆã®å®‰å®šæ€§ã‚’ç¶­æŒã™ã‚‹ã€Œè‰¯ã„ã¨ã“å–ã‚Šã€ãŒæœ€é©è§£ã ã¨æ€ã„ã¾ã™ã€‚



å“è³ªè©•ä¾¡è‡ªä½“ã¯ã¨ã¦ã‚‚é‡è¦ã§ã™ã€ãªãœãªã‚‰äººé–“ã®è©•ä¾¡è»¸ã ã‘ã ã¨ã›ã„ãœã„æ•°ç™¾ç¨‹åº¦ãã‚‰ã„ã—ã‹è©•ä¾¡ã§ãã¾ã›ã‚“ãŒã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¸Šã‹ã‚‰å“è³ªè©•ä¾¡ã§ãã‚‹ã€Œè©•ä¾¡è»¸ã€ã¨ã„ã†ã‚‚ã®ã‚’ä½œã‚‹ã“ã¨ã¯ã¨ã¦ã‚‚é‡è¦ã§ã™ã€ãªã®ã§ã“ã‚Œã‚’æ¶ˆã™ã‚ã‘ã«ã¯è¡Œãã¾ã›ã‚“ã€ãŸã ã—50%å“è³ªã¨ã„ã†ã®ãŒç›®æ¨™å€¤ãŒé«˜ã™ãã¦å•é¡Œã ã£ãŸã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€ã©ã‚“ãªç”»åƒã§ã‚‚ä¸€æ—¦ã¯å…¨éƒ¨é€šã™ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€ãã†ã™ã‚Œã°ã“ã®å•é¡Œã¯ä¸€æ™‚çš„ã«è§£æ±ºã™ã‚‹ã¨æ€ã†ãŠã®ã§ã™ãŒèªè­˜ã‚ã£ã¦ã¾ã™ã‹ï¼Ÿ
ã‚ã£ã¦ãŸã‚‰ã€é‡è¦ãªã“ã¨ãªã®ã§ã€docs/workflows ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã€Œå“è³ªæŒ‡æ¨™ã€ã«é–¢ã—ã¦ã€ä»Šå›ã®ã“ã¨ã‚’è¿½è¨˜ã—ã¦ãã ã•ã„

ã„ã‚„ã€ã„ã£ãŸã‚“ä»Šã®çŠ¶æ…‹ã‚’å®Œå…¨ã«ä¿æŒã—ã¦ãŠããŸã„ã®ã§/releaseã—ã¦

>ã§ã¯extract_character.pyã®å®Ÿè£…ã‚‚ãã†ã—ã¦ãã ã•ã„

ã™ã„ã¾ã›ã‚“ã€ç¶šè¡Œã—ã¦ã€åŸºæœ¬ç¾å ´ã¯ã™ã¹ã¦é€šã—
  3. æ¨å¥¨é–¾å€¤è¨­å®šæŒ‡é‡
  å“è³ªé–¾å€¤è¨­å®šæŒ‡é‡:
    å‡¦ç†ç¶™ç¶š: å…¨ã¦é€šã™ï¼ˆ0%é–¾å€¤ï¼‰
    ç•°å¸¸è­¦å‘Š: 5%æœªæº€ã§è­¦å‘Šå‡ºåŠ›
    çµ±è¨ˆç›£è¦–: 10%æœªæº€ã§çµ±è¨ˆãƒ•ãƒ©ã‚°
    æ”¹å–„æ¤œè¨: 15%æœªæº€ã§æ”¹å–„å€™è£œ
    ç›®æ¨™å“è³ª: 30%ä»¥ä¸Šï¼ˆæ®µéšçš„å‘ä¸Šï¼‰



>  - 3æ®µéšå‡¦ç†:
    a. é©å¿œçš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
    b. YOLOæ¤œå‡ºç¯„å›²æ‹¡å¼µ
    c. SAMç²¾å¯†ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å†å®Ÿè¡Œ
  - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹: æœ€å¤§3å›ã¾ã§è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
>  - å­¦ç¿’æ©Ÿèƒ½: å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜éŒ²ãƒ»å­¦ç¿’

ã™ã„ã¾ã›ã‚“ã€ã“ã®3æ®µéšå‡¦ç†ã‚’ã„ã‚Œã‚‹ã“ã¨ã§ã‚ˆã‚Šè‰¯ããªã‚Šãã†ã«è¦‹ãˆã‚‹ã®ã§ã™ãŒä½•ãŒå•é¡Œãªã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã“ã‚Œã¯å“è³ªè©•ä¾¡ã®ã‚ˆã†ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®é©ç”¨ã®ã—ã™ãã§ç ´ç¶»ã—ã¦ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ


ã§ã¯ã“ã®å†…å®¹ã‚‚docs/workflows ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦ãã ã•ã„

>>  - 3æ®µéšå‡¦ç†:
    a. é©å¿œçš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
    b. YOLOæ¤œå‡ºç¯„å›²æ‹¡å¼µ
    c. SAMç²¾å¯†ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å†å®Ÿè¡Œ
  - ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹: æœ€å¤§3å›ã¾ã§è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
>  - å­¦ç¿’æ©Ÿèƒ½: å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¨˜éŒ²ãƒ»å­¦ç¿’

ã“ã‚Œã¯å…¨éƒ¨ãªãã™ã¹ãï¼Ÿãã‚Œã¨ã‚‚ä»Šå¾Œæ®µéšçš„ã«å¾ã€…ã«å°å…¥ã™ã‚‹ã‹ã‚‰ã¨ã‚Šã‚ãˆãšæ®‹ã™ã ã‘æ®‹ã™ã¹ãï¼Ÿ

> ğŸ“‹ æ¨å¥¨å®Ÿè£…æ–¹é‡
>
  å³åº§ã«å®Ÿè¡Œï¼š
>  1. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç„¡åŠ¹åŒ–: QCæˆåŠŸç‰ˆã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«
  1. ãƒ•ãƒ©ã‚°åˆ¶å¾¡: --enable-advanced-pipeline ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½
>  1. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½: å¤±æ•—æ™‚ã¯QCæˆåŠŸç‰ˆã«è‡ªå‹•åˆ‡ã‚Šæ›¿ãˆ

ï¼‘ã§ã¯ãã®ã‚ˆã†ã«extract_character.pyã‚’å¯¾å¿œã—ã¦ãã ã•ã„
ï¼’ã‚ã¨ docs/workflows ä»¥ä¸‹ã‚‚ã—ãã¯ãƒ«ãƒ¼ãƒˆç›´ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«3æ®µéšå‡¦ç†ãŒè¨˜è¿°ã•ã‚ŒãŸã‚‰ã“ã®ã“ã¨ã‚’æ›´æ–°ã—ã¦ã»ã—ã„





ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼ãƒ¼

å•é¡Œã£ã¦ã®ã“ã‚Šã©ã‚Œã ã‘ã‚ã‚‹ã‚“ã§ã—ãŸã£ã‘ï¼Ÿ

>[done]  # å•é¡Œè¦å› 1: P1-B004è¤‡é›‘ãªé©å¿œçš„ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°
  from features.processing.adaptive_cropping import AdaptiveCropping
[done]  # å•é¡Œè¦å› 2: è¤‡é›‘ãªå“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
>  quality_result = evaluate_extraction_quality(...)
  if quality_result.grade in ['C', 'D', 'E', 'F']:
      # è¤‡é›‘ãªæ”¹å–„å‡¦ç†
  # å•é¡Œè¦å› 3: è¤‡æ•°ã®è©•ä¾¡æ‰‹æ³•åˆ‡ã‚Šæ›¿ãˆ
>  quality_methods = ['balanced', 'confidence', 'size', 'fullbody', 'central']
  # å•é¡Œè¦å› 4: é–“é•ã£ãŸå‡ºåŠ›å½¢å¼ï¼ˆP1-B004ã§å¤‰æ›´ã•ã‚ŒãŸï¼‰
>  output_path_single = output_dir / f'{img_path.stem}_extracted.jpg'

ã„ã£ãŸã‚“å•é¡Œã®é€²æ—ã£ã¦ã“ã‚“ãªæ„Ÿã˜ã§ï¼“ã¤æ®‹ã£ã¦ã‚‹ã‹ã‚“ã˜ã§ã—ã‚‡ã†ã‹ï¼Ÿèªè­˜ã‚ã£ã¦ã¾ã™ã‹ï¼Ÿ


>  âŒ å•é¡Œè¦å› 2: è¤‡é›‘ãªå“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
  - ç¾çŠ¶: âš ï¸ éƒ¨åˆ†çš„è§£æ±º
>  - ã‚³ãƒ¼ãƒ‰å†…ã« evaluate_extraction_quality(...) ã®å‘¼ã³å‡ºã—ã¯å­˜åœ¨ã—ãªã„
  - ã—ã‹ã—ã€è¤‡é›‘ãªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã¯æ®‹å­˜ï¼š

è¤‡é›‘ãªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã£ã¦ãªã‚“ã§ã—ãŸã£ã‘ï¼Ÿ

weight_configã§ã™ãŒã€

centralã£ã¦
ãƒã‚¹ã‚¯ãŒç”»åƒã®ä¸­å¿ƒã«è¿‘ã„ã‹	ã€ãƒã‚¹ã‚¯ãŒç”»åƒã®ä¸­å¿ƒã«è¿‘ã„ã‹	ã£ã¦ã„ã†æ„å‘³ãªã‚“ã§ã™ã­ã€ã“ã‚Œå…¨ç„¶ã„ã‚‰ãªã„ã§ã™ã‚ˆ
ç”»é¢ã®å³åŠåˆ†ã«å‰é€²ã‚’ã¶ã¡æŠœãã‚³ãƒã§è¡¨ç¤ºã•ã›ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã—ã€ãƒšãƒ¼ã‚¸ã‚’æ¨ªä¸‰åˆ†å‰²ã—ã¦ã¦ä¸€ç•ªä¸‹ã®ã‚³ãƒã®ã‚­ãƒ£ãƒ©ãŒæŠ½å‡ºç®‡æ‰€ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã—ã“ã‚Œã£ã¦é‡è¦åº¦ã¯ã‹ãªã‚Šä½ã„ã§ã™

grounded	ãƒã‚¹ã‚¯ãŒä¸‹å´ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹ã‹	åœ°é¢ã«ç«‹ã£ã¦ã„ã‚‹é¢¨ã«è¦‹ãˆã‚‹ã‹
ã“ã‚Œã‚‚æ„å‘³ã‚ã‹ã‚‰ãªã„ã§ã™ã€æ¼«ç”»ãªã®ã§åœ°é¢ã«ç«‹ã£ã¦ã‚‹ã‹ã©ã†ã‹ã‚„å½±ãªã©ã¯ã‹ãªã‚Šçœç•¥ã•ã‚Œã¦ã¾ã™


ã“ã‚Œã‚‰ã®ã“ã¨ã‚’è€ƒæ…®ã—ã¦ã€æ¶ˆã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿæ®‹ã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿ

>  å®Ÿéš›ã®ã¨ã“ã‚ã€QCæˆåŠŸç‰ˆã® masks[np.argmax(scores)] ãŒ100%æˆåŠŸã—ã¦ã„ã‚‹ä»¥ä¸Šã€è¤‡é›‘ãªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°è‡ªä½“ãŒä¸è¦ã§ã™ã€‚
  çµè«–: centralã¨groundedã¯å®Œå…¨å‰Šé™¤ã€ã‚€ã—ã‚è¤‡é›‘ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°å…¨ä½“ã‚’å‰Šé™¤ã—ã¦QCæˆåŠŸç‰ˆã®å˜ç´”æ‰‹æ³•ã«æˆ»ã™ã¹ãã§ã™ã€‚

ã§ã¯å®Ÿè£…ã‚‚ãã†ã—ã¦ãã ã•ã„ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚ãã®æ—¨è¨˜è¼‰ãŠé¡˜ã„



>[done]  # å•é¡Œè¦å› 1: P1-B004è¤‡é›‘ãªé©å¿œçš„ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°
  from features.processing.adaptive_cropping import AdaptiveCropping
[done]  # å•é¡Œè¦å› 2: è¤‡é›‘ãªå“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
>  quality_result = evaluate_extraction_quality(...)
  if quality_result.grade in ['C', 'D', 'E', 'F']:
      # è¤‡é›‘ãªæ”¹å–„å‡¦ç†
 [done] # å•é¡Œè¦å› 3: è¤‡æ•°ã®è©•ä¾¡æ‰‹æ³•åˆ‡ã‚Šæ›¿ãˆ
>  quality_methods = ['balanced', 'confidence', 'size', 'fullbody', 'central']
  # å•é¡Œè¦å› 4: é–“é•ã£ãŸå‡ºåŠ›å½¢å¼ï¼ˆP1-B004ã§å¤‰æ›´ã•ã‚ŒãŸï¼‰
>  output_path_single = output_dir / f'{img_path.stem}_extracted.jpg'

ã„ã£ãŸã‚“å•é¡Œã®é€²æ—ã£ã¦ã“ã‚“ãªæ„Ÿã˜ã§1ã¤æ®‹ã£ã¦ã‚‹ã‹ã‚“ã˜ã§ã—ã‚‡ã†ã‹ï¼Ÿèªè­˜ã‚ã£ã¦ã¾ã™ã‹ï¼Ÿ


ã€ã€ã€
å®Ÿè¡Œä¸­ï¼Ÿã¾ã ãªã‚“ã®å‡ºåŠ›ã‚‚ã•ã‚Œã¦ãªã•ãã†




 /mnt/c/AItools/lora/train/yado/tracker-workspace/QC-KANA08-RESTORED-FINAL/extraction
ã‚’ã¿ãŸã®ã§ã™ãŒã€æ®‹å¿µãªãŒã‚‰åŒã˜æŠ½å‡ºã«ã¯è‡³ã‚‰ãªã‹ã£ãŸã§ã™ã€QCæˆåŠŸä¾‹ã¨æ¯”è¼ƒã—ã¦ã€ã©ã†ã„ã†ã¨ã“ã‚ã§é•ã„ãŒã‚ã‚‹ã‹ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„



> QCæˆåŠŸç‰ˆã®å®Œå…¨å†ç¾ã«ã¯ä»¥ä¸‹ãŒå¿…è¦:
  1. ç”»åƒãƒªã‚µã‚¤ã‚ºã‚’ç„¡åŠ¹åŒ–ï¼ˆå…ƒã‚µã‚¤ã‚ºã§å‡¦ç†ï¼‰
ã“ã‚Œã¯å…ƒã‚µã‚¤ã‚ºã§ãªãŠã—ã¦

>  1. YOLOãƒ¢ãƒ‡ãƒ«ã‚’yolov8x.ptã«çµ±ä¸€

ä»–ã®ãƒ¢ãƒ‡ãƒ«ã‚’åˆ©ç”¨ã—ã¦ãŸã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿ

>  2. ã‚·ãƒ³ãƒ—ãƒ«ãªSAMå‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

ä»Šã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã£ã¦ã©ã†ãªã£ã¦ã‚‹ã®ï¼Ÿ

>  2. è¤‡é›‘ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’ç„¡åŠ¹åŒ–

ã“ã‚Œã¯ç„¡åŠ¹åŒ–ã—ã¦ãŸã®ã§ã¯ï¼Ÿ


ã‚‚ã†ä¸€åº¦æŠ½å‡ºãƒãƒƒãƒã‚’å®Ÿè¡Œã—ã¦ã€‚ã“ã‚“ã©ã“ãQCæˆåŠŸä¾‹ã¨åŒç­‰ã®çµæœã«å‡ºã‚ˆã†ã«ã—ã¦
input /mnt/c/AItools/lora/train/yado/org/kana08/
output /mnt/c/AItools/lora/train/yado/tracker-workspace/QC-KANA08-RESTORED-080401/extraction
